<div class="paging">
	<%= 
		def generate_link(page_number) 
			link_to(page_number, search_path(page_number, @query_params))
		end

		def generate_links(from, to)
			result = ""

			(from .. to).each do |num|
				result << generate_link(num)
			end

			result
		end

		def generate_dynamic_links_side(from, to, cutoff, left_count, right_count)
			result = ""

			if to - from < cutoff
				result << generate_links(from, to)
			else
				result << generate_links(from, from + left_count)
				result << content_tag('span', '...')
				result << generate_links(to - right_count, to)
			end

			result
		end

		def generate_dynamic_links(current_page, page_count)
			result = ""

			cutoff = 7
			outer_side = 2
			inner_side = 1

			result << generate_dynamic_links_side(1, current_page - 1, cutoff, outer_side, inner_side)
			result << generate_link(current_page)
			result << generate_dynamic_links_side(current_page + 1, page_count, cutoff, inner_side, outer_side)

			result.html_safe
		end

		generate_dynamic_links(@page_number, @page_count)
	%>
</div>
